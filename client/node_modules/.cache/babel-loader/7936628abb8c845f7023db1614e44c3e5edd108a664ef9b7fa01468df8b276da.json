{"ast":null,"code":"var _jsxFileName = \"D:\\\\mern_app_mini\\\\client\\\\src\\\\pages\\\\StudentManagementPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport studentService from '../services/studentService';\nimport StudentTable from '../components/StudentTable'; // Assuming you create this\nimport StudentForm from '../components/StudentForm'; // Assuming you create this\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction StudentManagementPage() {\n  _s();\n  const [students, setStudents] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [editingStudent, setEditingStudent] = useState(null); // Student object for editing, or null for adding\n  const [showForm, setShowForm] = useState(false); // Toggle visibility of the form\n\n  // Fetch students\n  const fetchStudents = useCallback(async () => {\n    setIsLoading(true);\n    setError('');\n    try {\n      const data = await studentService.getStudents(); // Add filters if needed {standard:'10', section:'A'}\n      setStudents(data);\n    } catch (err) {\n      setError(err.message || 'Failed to fetch students');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []); // No dependencies if fetching all initially\n\n  useEffect(() => {\n    fetchStudents();\n  }, [fetchStudents]);\n\n  // Handle Save (Add or Update)\n  const handleSaveStudent = async studentData => {\n    setIsLoading(true);\n    setError('');\n    try {\n      if (editingStudent) {\n        // Update\n        await studentService.updateStudent(editingStudent._id, studentData);\n      } else {\n        // Add\n        await studentService.addStudent(studentData);\n      }\n      setEditingStudent(null); // Reset editing state\n      setShowForm(false); // Hide form after save\n      fetchStudents(); // Refresh the list\n    } catch (err) {\n      setError(err.message || `Failed to ${editingStudent ? 'update' : 'add'} student`);\n      // Keep form open on error? Maybe not, let user retry.\n      // setShowForm(true);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Handle Edit button click\n  const handleEdit = student => {\n    setEditingStudent(student);\n    setShowForm(true); // Show form when editing\n  };\n\n  // Handle Add New button click\n  const handleAddNew = () => {\n    setEditingStudent(null); // Ensure form is in 'add' mode\n    setShowForm(true); // Show form\n  };\n\n  // Handle Delete (Deactivate) button click\n  const handleDelete = async studentId => {\n    if (window.confirm('Are you sure you want to deactivate this student?')) {\n      setIsLoading(true);\n      setError('');\n      try {\n        await studentService.deactivateStudent(studentId);\n        fetchStudents(); // Refresh the list\n      } catch (err) {\n        setError(err.message || 'Failed to deactivate student');\n      } finally {\n        setIsLoading(false);\n      }\n    }\n  };\n\n  // Handle closing the form\n  const handleCloseForm = () => {\n    setShowForm(false);\n    setEditingStudent(null); // Clear editing state when closing\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Manage Students\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: [\"Error: \", error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 23\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleAddNew,\n      disabled: showForm,\n      style: {\n        marginBottom: '1rem'\n      },\n      children: \"Add New Student\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 14\n    }, this), showForm && /*#__PURE__*/_jsxDEV(StudentForm, {\n      initialData: editingStudent // Pass student data for editing, or null for adding\n      ,\n      onSave: handleSaveStudent,\n      onCancel: handleCloseForm // Add a cancel button to the form\n      ,\n      isLoading: isLoading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 17\n    }, this), isLoading && !showForm && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading students...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 41\n    }, this), \" \", !isLoading && !showForm && students.length > 0 && /*#__PURE__*/_jsxDEV(StudentTable, {\n      students: students,\n      onEdit: handleEdit,\n      onDelete: handleDelete\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 17\n    }, this), !isLoading && !showForm && students.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No students found.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 9\n  }, this);\n}\n_s(StudentManagementPage, \"MTHBpAKB6nPx6yVukoXzCNqG9vs=\");\n_c = StudentManagementPage;\nexport default StudentManagementPage;\nvar _c;\n$RefreshReg$(_c, \"StudentManagementPage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","studentService","StudentTable","StudentForm","jsxDEV","_jsxDEV","StudentManagementPage","_s","students","setStudents","isLoading","setIsLoading","error","setError","editingStudent","setEditingStudent","showForm","setShowForm","fetchStudents","data","getStudents","err","message","handleSaveStudent","studentData","updateStudent","_id","addStudent","handleEdit","student","handleAddNew","handleDelete","studentId","window","confirm","deactivateStudent","handleCloseForm","children","fileName","_jsxFileName","lineNumber","columnNumber","style","color","onClick","disabled","marginBottom","initialData","onSave","onCancel","length","onEdit","onDelete","_c","$RefreshReg$"],"sources":["D:/mern_app_mini/client/src/pages/StudentManagementPage.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport studentService from '../services/studentService';\r\nimport StudentTable from '../components/StudentTable'; // Assuming you create this\r\nimport StudentForm from '../components/StudentForm';   // Assuming you create this\r\n\r\nfunction StudentManagementPage() {\r\n    const [students, setStudents] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [editingStudent, setEditingStudent] = useState(null); // Student object for editing, or null for adding\r\n     const [showForm, setShowForm] = useState(false); // Toggle visibility of the form\r\n\r\n    // Fetch students\r\n    const fetchStudents = useCallback(async () => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            const data = await studentService.getStudents(); // Add filters if needed {standard:'10', section:'A'}\r\n            setStudents(data);\r\n        } catch (err) {\r\n            setError(err.message || 'Failed to fetch students');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, []); // No dependencies if fetching all initially\r\n\r\n    useEffect(() => {\r\n        fetchStudents();\r\n    }, [fetchStudents]);\r\n\r\n    // Handle Save (Add or Update)\r\n    const handleSaveStudent = async (studentData) => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            if (editingStudent) {\r\n                // Update\r\n                await studentService.updateStudent(editingStudent._id, studentData);\r\n            } else {\r\n                // Add\r\n                await studentService.addStudent(studentData);\r\n            }\r\n            setEditingStudent(null); // Reset editing state\r\n             setShowForm(false); // Hide form after save\r\n            fetchStudents(); // Refresh the list\r\n        } catch (err) {\r\n            setError(err.message || `Failed to ${editingStudent ? 'update' : 'add'} student`);\r\n             // Keep form open on error? Maybe not, let user retry.\r\n             // setShowForm(true);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    // Handle Edit button click\r\n    const handleEdit = (student) => {\r\n        setEditingStudent(student);\r\n         setShowForm(true); // Show form when editing\r\n    };\r\n\r\n     // Handle Add New button click\r\n    const handleAddNew = () => {\r\n         setEditingStudent(null); // Ensure form is in 'add' mode\r\n        setShowForm(true); // Show form\r\n    };\r\n\r\n    // Handle Delete (Deactivate) button click\r\n    const handleDelete = async (studentId) => {\r\n         if (window.confirm('Are you sure you want to deactivate this student?')) {\r\n             setIsLoading(true);\r\n             setError('');\r\n             try {\r\n                 await studentService.deactivateStudent(studentId);\r\n                 fetchStudents(); // Refresh the list\r\n             } catch (err) {\r\n                 setError(err.message || 'Failed to deactivate student');\r\n             } finally {\r\n                 setIsLoading(false);\r\n             }\r\n         }\r\n    };\r\n\r\n     // Handle closing the form\r\n    const handleCloseForm = () => {\r\n         setShowForm(false);\r\n        setEditingStudent(null); // Clear editing state when closing\r\n     };\r\n\r\n    return (\r\n        <div>\r\n            <h2>Manage Students</h2>\r\n            {error && <p style={{ color: 'red' }}>Error: {error}</p>}\r\n\r\n             <button onClick={handleAddNew} disabled={showForm} style={{ marginBottom: '1rem' }}>\r\n                Add New Student\r\n            </button>\r\n\r\n            {/* Conditionally render the form */}\r\n            {showForm && (\r\n                <StudentForm\r\n                    initialData={editingStudent} // Pass student data for editing, or null for adding\r\n                    onSave={handleSaveStudent}\r\n                     onCancel={handleCloseForm} // Add a cancel button to the form\r\n                    isLoading={isLoading}\r\n                />\r\n            )}\r\n\r\n\r\n             {isLoading && !showForm && <p>Loading students...</p>} {/* Show loading only when fetching list */}\r\n\r\n             {!isLoading && !showForm && students.length > 0 && (\r\n                <StudentTable\r\n                    students={students}\r\n                    onEdit={handleEdit}\r\n                    onDelete={handleDelete}\r\n                />\r\n            )}\r\n\r\n            {!isLoading && !showForm && students.length === 0 && (\r\n                <p>No students found.</p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default StudentManagementPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}